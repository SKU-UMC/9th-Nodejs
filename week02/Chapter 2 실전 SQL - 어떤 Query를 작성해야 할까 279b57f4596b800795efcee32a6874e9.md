# Chapter 2. 실전 SQL - 어떤 Query를 작성해야 할까?

## 📝 학습 목표

---

1. 1주차 때 예시를 기반으로 여러가지 요구 사항에 대한 SQL 쿼리를 고민한다.
2. paging을 고려하여 쿼리를 작성한다.

## 📸 잠깐 ! 스터디 인증샷은 찍으셨나요?📸

---

* 스터디리더께서 대표로 매 주차마다 한 장 남겨주시면 좋겠습니다!🙆💗
 (사진을 저장해서 이미지 임베드를 하셔도 좋고, 복사+붙여넣기해서 넣어주셔도 좋습니다!)

[](https://www.notion.so)

## 📑 2주차 주제

---

다들 데이터베이스 설계(1주차 미션)는 잘 하셨나요?

- 저 같은 경우는 아래의 형태로 설계를 했습니다. (참고해주세요!)
    
    ❗1주차 미션에 포함되지 않는 부분은 설계를 하지 않았습니다!
    
    ![1주차 미션 ERD](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/image.png)
    
    1주차 미션 ERD
    
    글씨가 잘 보이지 않는다면 링크를 참고하시면 됩니다! 
    
    [umc9th2week](https://www.erdcloud.com/d/k7phBagbMpAeiTZBj)
    

이번 주차는 **몇 가지 요구 사항에 대해 어떻게 쿼리를 만들어야 하는지 같이 고민**해보는 주차입니다.

***join, subquery는 알고 있다는 전제로 시작합니다!***

- 참고 자료
    
    [SQL 기본 문법: JOIN(INNER, OUTER, CROSS, SELF JOIN)](https://hongong.hanbit.co.kr/sql-기본-문법-joininner-outer-cross-self-join/)
    
    [[SQL] 테이블 JOIN의 개념과 예제](https://velog.io/@wijoonwu/JOIN)
    
    [[MYSQL] 📚 테이블 조인(JOIN) - 그림으로 알기 쉽게 정리](https://inpa.tistory.com/entry/MYSQL-📚-JOIN-조인-그림으로-알기쉽게-정리)
    
    [SQL / MySQL 서브쿼리(SubQuery)](https://snowple.tistory.com/360)
    
    [[MYSQL] 📚 서브쿼리 개념 & 문법 💯 정리](https://inpa.tistory.com/entry/MYSQL-📚-서브쿼리-정리)
    

😉 ***mysql 기준으로 진행합니다.***

## 🔖 2주차 본문

---

기존 1주차 워크북 본문서 요구하던 요구 사항,
그리고 전 미션(1주차 미션)에서 요구했던 요구 사항 일부에 대해

**어떻게 쿼리를 만드는 것이 좋을지 고민**을 해봅시다.

query 역시 Database 설계처럼 **정해진 답이 없고**,
**join을 사용할 지 혹은 subquery를 사용할 지 선택**하시면 됩니다!

그리고 너무 무리해서 **한번에 거대한 query를 보내기 보다는 힘들 경우,
2개로 쪼개서 보내는 것**도 좋습니다.

특히 복잡한 쿼리를 작성할 때는 같은 쿼리라도 어떤 쿼리가 더 효율적인지 여러 가지 테스트 방법을 통해서 확인하는 것도 좋습니다. 

워낙 ORM과 같은 도구들이 우리를 편하게 해주긴 하지만, 그럼에도 불구하고 직접 쿼리 짜는 연습을 해두면 그 노력이 언젠가 빛을 발할 날이 있을 거에요. 

### 🔮 SQL 마스터 도전

<aside>
💡 본격적으로 어떤 쿼리가 좋은 쿼리인지 고민해보기 전에, 예제로 워밍업을 해봅시다!

</aside>

[Chapter 2. 실전 SQL- 워밍업 ](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL-%20%EC%9B%8C%EB%B0%8D%EC%97%85%20279b57f4596b812aa6b8df6152ab78f1.md)

### 💜 여러 요구 사항에 대응하기

<aside>
💡 워밍업 했던 내용들을 토대로 여러 요구 사항에 대응하는 쿼리를 짜봅시다.

</aside>

[Chapter 2. 실전 SQL- 어떤 Query를 작성해야 할까? ](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b81a4a923e6328de4f877.md)

### 💟 페이지네이션 배워보기

<aside>
💡 Offset 기반 페이징과 Cursor 기반 페이징에 대해 배워봅시다.

</aside>

[Chapter 2. 실전 SQL- SQL과 페이지네이션 ](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL-%20SQL%EA%B3%BC%20%ED%8E%98%EC%9D%B4%EC%A7%80%EB%84%A4%EC%9D%B4%EC%85%98%20279b57f4596b81a888bae030b6a97d8e.md)

## ✍️ 2주차를 마치며

---

수고하셨습니다 :) 이 내용은 가볍게 읽고 넘어가 볼게요. 다음주도 화이팅! 

### 👾 쿼리 실행 흐름

<aside>
💡 쿼리는 서버에 어떻게 반영되는 걸까요?

</aside>

[Chapter 2 BOUNS. 내가 짠 쿼리는 어떻게 반영되는걸까? ](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/Chapter%202%20BOUNS%20%EB%82%B4%EA%B0%80%20%EC%A7%A0%20%EC%BF%BC%EB%A6%AC%EB%8A%94%20%EC%96%B4%EB%96%BB%EA%B2%8C%20%EB%B0%98%EC%98%81%EB%90%98%EB%8A%94%EA%B1%B8%EA%B9%8C%20279b57f4596b819e81b7eeb0e11e8398.md)

# 🎯 핵심 키워드

---

<aside>
💡 주요 내용들에 대해 조사해보고, 자신만의 생각을 통해 정리해보세요!
레퍼런스를 참고하여 정의, 속성, 장단점 등을 적어주셔도 됩니다.
조사는 공식 홈페이지 **Best**, 블로그(최신 날짜) **Not Bad**

</aside>

- 데이터베이스 정규화
    
    데이터베이스 정규화는 **중복과 이상현상을 제거**하여 데이터를 효율적으로 저장하는 설계
    
    정규화의 목적
    
    - **중복 제거**
    - **이상현상 방지**: 삽입/수정/삭제 시 발생하는 문제 해결
    - **저장공간 절약**: 불필요한 중복 데이터 제거
    
    제 1정규형-모든 속성은 반드시 하나의 값만 가져한다
    
    제 2정규형-엔터티의 모든 일반속성은 반드시 모든 주식별자에 종속되어야 한다.
    
    제 3정규형-주식별자가 아닌 모든 속성 간에는 서로 종속될 수 없다
    
- 인덱스(Index)
    
    인덱스란 추가적인 쓰기 작업과 저장 공간을 활용하여 데이터베이스 테이블의 검색 속도를 향상시키기 위한 자료구조이다.
    
    인덱스를 활용하면, 데이터를 조회하는 SELECT 외에도 UPDATE나 DELETE의 성능이 함께 향상된다. 그러한 이유는 해당 연산을 수행하려면 해당 대상을 조회해야만 작업을 할 수 있기 때문이다.
    
    - 장점
        - 테이블을 조회하는 속도와 그에 따른 성능을 향상시킬 수 있다.
        - 전반적인 시스템의 부하를 줄일 수 있다.
    - 단점
        - 인덱스를 관리하기 위해 DB의 약 10%에 해당하는 저장공간이 필요하다.
        - 인덱스를 관리하기 위해 추가 작업이 필요하다.
        - 인덱스를 잘못 사용할 경우 오히려 성능이 저하되는 역효과가 발생할 수 있다.
- ORM VS Raw SQL
    
    ORM을 사용하기 전 Raw SQL
    
    SQL Query(Raw Query)를 직접 만들어서 보냄
    
    - 개발 프로그래밍과 DB 쿼리코드가 서로 종속된다.
    
    이러한 문제점들을 해결하기 위해 ORM이 등장
    
    - 개발 코드와 DB를 아예 분리하면서 객체지향의 의도에 적합하게 되었다.
    
    **Object-Relational Mapping**
    
    - 객체와 관계형 데이터베이스의 데이터를 자동으로 매핑해주는 것
        - 객체 지향 프로그래밍은 **클래스**를 사용하고, 관계형 데이터베이스는 **테이블**을 사용
            
            → 객체 모델과 관계형 모델 간에 불일치
            
        - ORM을 통해 객체 간의 관계를 바탕으로 SQL을 자동으로 생성하여 불일치를 해결
    - 데이터베이스 데이터 <- 매핑 -> Object 필드
        - 객체를 통해 간접적으로 데이터베이스 데이터를 다룸.
    - Persistant API라고도 부른다.
        - Ex) JPA, Hibernate
    
    **ORM의 장단점**
    
    - 장점
        - 객체 지향적인 코드로 인해 더 직관적이고, 비즈니스 로직에 더 집중할 수 있게 한다
        - 재사용성 및 유지보수의 편리성이 증가
            - 객체들을 재활용할 수 있다.
    - 단점
        - ORM으로만 서비스를 구현하기가 어렵다

## 📢 학습 후기

---

- 이번 주차 워크북을 해결해보면서 어땠는지 회고해봅시다.
- 핵심 키워드에 대해 완벽하게 이해했는지? 혹시 이해가 안 되는 부분은 뭐였는지?

<aside>
💡 sql에 대해서는 올해 수업을 듣거나 자격증 취득을 준비하면서 많이 접할 수 있었다. 평소 나는 join을 활용해 데이터를 조회하는 것을 더 선호하는 편인데, 서브 쿼리를 이용했을 때 다중 join을 이용하는 것보다 더 디테일하게 조회가 가능했던 경험이 몇 번 있어서 이번 워크북에서는 서브 쿼리를 익히는 것에 개인적으로 중점을 두고 학습을 했다.

페이지네이션을 구현해본 적은 있지만, 어떤 원리로 이루어지는 지에 대해 지식이 부족했는데, 이번 워크북의 두 가지 방식에 대해 학습하고 나니, ‘아 그때 코드가 이런 구조였었구나’하는 깨달음도 있었다. 특히 cursor based 방식을 이해하는 데 시간을 많이 할애한 것 같다 !

</aside>

## ⚠️ 스터디 진행 방법

---

1. 스터디를 진행하기 전, 워크북 내용들을 모두 채우고 스터디에서는 서로 모르는 내용들을 공유해주세요.
2. 미션은 워크북 내용들을 모두 완료하고 나서 스터디 전/후로 진행해보세요.
3. 다음주 스터디를 진행하기 전, 지난주 미션을 서로 공유해서 상호 피드백을 진행하시면 됩니다.

## ✅ 실습 체크리스트

---

- [x]  SQL 마스터 도전
- [x]  여러 요구 사항에 대응하기
- [x]  페이지네이션 배워보기
- [x]  쿼리 실행 흐름 알아보기

## ☑️ 실습 인증

---

![image.png](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/image%201.png)

![IMG_2546.jpeg](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/IMG_2546.jpeg)

![image.png](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/image%202.png)

![IMG_2547.jpeg](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/IMG_2547.jpeg)

![IMG_2548.jpeg](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/IMG_2548.jpeg)

## ✨ 위클리 스크럼 과제

---

위클리 스크럼 과제는 OO주차 위클리 스크럼 아이스 브레이킹과 공통 질문을 모두 작성한 후, 아래에 질문을 복사 붙여넣기 한 다음 다같이 작성해주시면 됩니다. 

1. ERD를 설계할 때 N:M 관계를 설계해야 할 일이 많은데 어떤 기준으로 매핑 테이블을 설계했나요?
2. DB를 설계하면서 처음에 그린 ERD에서 바뀐 부분이 있었나요? 어떤 부분이었고 왜 바꿨나요? 
    
    → created_at & updated_at에 대한 고민
    
    → store - category 연결 추가함
    

## 🔥 미션

---

1. 1주차 때 설계한 데이터베이스를 토대로 아래의 화면에 대한 쿼리를 작성

![내가 진행중, 진행 완료한 미션 모아서 보는 쿼리(페이징 포함)](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/Untitled.png)

내가 진행중, 진행 완료한 미션 모아서 보는 쿼리(페이징 포함)

![리뷰 작성하는 쿼리,
* 사진의 경우는 일단 배제](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/Untitled%201.png)

리뷰 작성하는 쿼리,
* 사진의 경우는 일단 배제

![홈 화면 쿼리
(현재 선택 된 지역에서 도전이 가능한 미션 목록, 페이징 포함)](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/Untitled%202.png)

홈 화면 쿼리
(현재 선택 된 지역에서 도전이 가능한 미션 목록, 페이징 포함)

![마이 페이지 화면 쿼리](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/Untitled%203.png)

마이 페이지 화면 쿼리

**< 시니어 미션 >**

[시니어 미션](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/%EC%8B%9C%EB%8B%88%EC%96%B4%20%EB%AF%B8%EC%85%98%20279b57f4596b81538dd1c298ce512d97.md)

## 💪 미션 기록 (여기에 해도 되고 위의 미션에서 각 페이지 밑에 간단하게 블록 만들어서 하셔도 됩니다!)

---

<aside>
🍀 미션 기록의 경우, 아래 미션 기록 토글 속에 작성하시거나, 페이지를 새로 생성하여 해당 페이지에 기록하여도 좋습니다!

하지만, 결과물만 올리는 것이 아닌, **중간 과정 모두 기록하셔야 한다는 점!** 잊지 말아주세요.

</aside>

- **미션 기록**
    
    [유채원 / 워크북 week02 - sql 작성](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/%EC%9C%A0%EC%B1%84%EC%9B%90%20%EC%9B%8C%ED%81%AC%EB%B6%81%20week02%20-%20sql%20%EC%9E%91%EC%84%B1%20279b57f4596b8117b221f7f7450af6e8.md)
    

## ⚡ 트러블 슈팅

---

<aside>
💡 실습하면서 생긴 문제들에 대해서, **이슈 - 문제 - 해결** 순서로 작성해주세요.

</aside>

<aside>
💡 스스로 해결하기 어렵다면? 스터디원들에게 도움을 요청하거나 **너디너리의 지식IN 채널에 질문**해보세요!

</aside>

- ⚡이슈 작성 예시 (이슈가 생기면 아래를 복사해서 No.1, No.2, No3 … 으로 작성해서 트러블 슈팅을 꼭 해보세요!)
    
    **`이슈`**
    
    👉 앱 실행 중에 노래 다음 버튼을 누르니까 앱이 종료되었다.
    
    **`문제`**
    
    👉 노래클래스의 데이터리스트의 Size를 넘어서 NullPointException이 발생하여 앱이 종료된 것이었다. 
    
    **`해결`**
    
    👉  노래 다음 버튼을 눌렀을 때 데이터리스트의 Size를 검사해 Size보다 넘어가려고 하면 다음으로 넘어가는 메서드를 실행시키지 않고, 첫 노래로 돌아가게끔 해결
    
    **`참고레퍼런스`**
    
    - 링크
- ⚡이슈 No.1
    
    **`이슈`**
    
    👉 [트러블이 생긴 상태 작성]
    
    **`문제`**
    
    👉 [어떤 이유로 해당 이슈가 일어났는지 작성]
    
    **`해결`**
    
    👉  [해결 방법 작성]
    
    **`참고레퍼런스`**
    
    - [문제 해결 시 참고한 링크]

## 🤔 참고 자료

[2주차](Chapter%202%20%EC%8B%A4%EC%A0%84%20SQL%20-%20%EC%96%B4%EB%96%A4%20Query%EB%A5%BC%20%EC%9E%91%EC%84%B1%ED%95%B4%EC%95%BC%20%ED%95%A0%EA%B9%8C%20279b57f4596b800795efcee32a6874e9/2%EC%A3%BC%EC%B0%A8%20279b57f4596b814283b2ccd3acaa6d20.csv)

---

Copyright © 2023 최용욱(똘이) All rights reserved.

Copyright © 2024, 2025 제이미(김준환) All rights reserved.

Copyright © 2025 전하경(재서) All rights reserved.